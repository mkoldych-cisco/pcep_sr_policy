<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
There has to be one entity for each item to be referenced. 
An alternate method (rfc include) is described in the references. -->

<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2629 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2629.xml">
<!ENTITY RFC3552 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3552.xml">
<!ENTITY I-D.narten-iana-considerations-rfc2434bis SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.narten-iana-considerations-rfc2434bis.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs), 
please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
(Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="no" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space 
(using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="std" docName="draft-ietf-pce-segment-routing-policy-cp-09" ipr="trust200902">
<!-- category values: std, bcp, info, exp, and historic
ipr values: full3667, noModification3667, noDerivatives3667
you can add the attributes updates="NNNN" and obsoletes="NNNN" 
they will automatically be output with "(if approved)" -->

<!-- ***** FRONT MATTER ***** -->

  <front>
    <title abbrev="PCEP SR Policy Association">
    PCEP extension to support Segment Routing Policy Candidate Paths</title>

    <author fullname="Mike Koldychev" initials="M." surname="Koldychev">
      <organization>Cisco Systems, Inc.</organization>
      <address>
        <postal>
          <street>2000 Innovation Drive</street>
          <city>Kanata</city>
          <region>Ontario</region>
          <code>K2K 3E8</code>
          <country>Canada</country>
        </postal>
        <email>mkoldych@cisco.com</email>
      </address>
    </author>



    <author fullname="Siva Sivabalan" initials="S." surname="Sivabalan">
      <organization>Ciena Corporation</organization>
      <address>
        <postal>
          <street>385 Terry Fox Dr.</street>
          <city>Kanata</city>
          <region>Ontario</region>
          <code>K2K 0L1</code>
          <country>Canada</country>
        </postal>
        <email>ssivabal@ciena.com</email>
      </address>
    </author>

    <author fullname="Colby Barth" initials="C." surname="Barth">
      <organization>Juniper Networks, Inc.</organization>
      <address>
        <email>cbarth@juniper.net</email>
      </address>
    </author>

    <author fullname="Shuping Peng" initials="S." surname="Peng">
      <organization>Huawei Technologies</organization>

       <address>
        <postal>
          <street>Huawei Campus, No. 156 Beiqing Rd.</street>

           <city>Beijing</city>

           <region/>

           <code>100095</code>

           <country>China</country>
        </postal>

         <phone/>

         <facsimile/>

         <email>pengshuping@huawei.com</email>

         <uri/>
      </address>
    </author>

    <author fullname="Hooman Bidgoli" initials="H." surname="Bidgoli">
      <organization>Nokia</organization>
      <address>
        <email>hooman.bidgoli@nokia.com</email>
      </address>
    </author>

    <date day="5" month="March" year="2023" />

    <workgroup>PCE Working Group</workgroup>

<abstract>

<t>A Segment Routing (SR) Policy (<xref target="RFC9256"/>) is a non-empty set of SR Candidate Paths, that all share the same &#60;headend, color, endpoint&#62; tuple.
This document extends <xref target="RFC8664"/> to fully support the SR Policy construct.
SR Policy is modeled in PCEP as an Association of one or more SR Candidate Paths.
PCEP extensions are defined to signal additional attributes of an SR Policy, which are not covered by <xref target="RFC8664"/>.
The mechanism is applicable to all data planes of SR (MPLS, SRv6, etc.).
</t>

</abstract> 

<note title="Requirements Language">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
      "MAY", and "OPTIONAL" in this document are to be interpreted as
      described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
      appear in all capitals, as shown here.</t>
</note>
</front>

<middle>

<section anchor="Introduction" title="Introduction">

<t>Path Computation Element (PCE) Communication Protocol (PCEP) <xref target="RFC5440"/> enables the communication between a Path Computation Client (PCC) and a Path Computation Element (PCE), or between two PCEs based on the PCE architecture <xref target="RFC4655"/>.</t>

<t>PCEP Extensions for the Stateful PCE Model <xref target="RFC8231"/> describes a set of extensions to PCEP to enable active control of Multiprotocol Label Switching Traffic Engineering (MPLS-TE) and Generalized MPLS (GMPLS) tunnels.  <xref target="RFC8281"/> describes the setup and teardown of PCE-initiated LSPs under the active stateful PCE model, without the need for local configuration on the PCC, thus allowing for dynamic centralized control of a network.</t>

<t>PCEP Extensions for Segment Routing <xref target="RFC8664"/> specifies extensions to the Path Computation Element Protocol (PCEP) that allow a stateful PCE to compute and initiate Traffic Engineering (TE) paths, as well as a PCC to request a path subject to certain constraint(s) and optimization criteria in SR networks.</t>

<t>PCEP Extensions for Establishing Relationships Between Sets of LSPs <xref target="RFC8697"/> introduces a generic mechanism to create a grouping of LSPs which can then be used to define associations between a set of LSPs and a set of attributes (such as configuration parameters or behaviors) and is equally applicable to stateful PCE (active and passive modes) and stateless PCE.</t>

<t>Segment Routing Policy for Traffic Engineering <xref target="RFC9256"/> details the concepts of SR Policy and approaches to steering traffic into an SR Policy.</t>

<t>
This document extends <xref target="RFC8664"/> to fully support the SR Policy construct.
SR Policy is modeled in PCEP as an Association of one or more SR Candidate Paths.
By associating multiple SR Candidate Paths, a PCE becomes aware of the hierarchical structure of an SR Policy.
Thus the PCE can take computation and control decisions about the Candidate Paths, with the additional knowledge that these Candidate Paths belong to the same SR Policy.
This is accomplished via the use of the PCEP Association object with a new association type.
</t>

</section> <!-- Introduction -->

<section anchor="Terminology" title="Terminology">

<t>The following terminologies are used in this document:

  <list style="hanging">
    
     <t hangText="Endpoint:"> The IPv4 or IPv6 endpoint address of the SR Policy in question, as described in <xref target="RFC9256"/>.</t>

     <t hangText="Association Parameters:"> As described in <xref target="RFC8697"/>, the combination of the mandatory fields Association Type, Association ID and Association Source in the ASSOCIATION object uniquely identify the association group.  If the optional TLVs - Global Association Source or Extended Association ID are included, then they MUST be included in combination with mandatory fields to uniquely identify the association group.</t>

     <t hangText="Association Information:"> As described in <xref target="RFC8697"/>, the ASSOCIATION object could also include other TLVs based on the association types, that provides non-key information.</t>

     <t hangText="SRPA:"> SR Policy Association. PCEP ASSOCATION that describes the SR Policy. Can refer to the PCEP object or to the group of LSPs that belong to the Association. This should be clear from the context.</t>

     <t hangText="PCC:"> Path Computation Client.  Any client application requesting a path computation to be performed by a Path Computation Element.</t>

     <t hangText="PCE:"> Path Computation Element.  An entity (component, application, or network node) that is capable of computing a network path or route based on a network graph and applying computational constraints.</t>

     <t hangText="PCEP:"> Path Computation Element Protocol.</t>

     <t hangText="PCEP Tunnel:"> The entity identified by the PLSP-ID, as per <xref target="I-D.koldychev-pce-operational"/>.</t>
    
      </list>
</t>

</section> <!-- Terminology -->

<section anchor="Motivation" title="Motivation">

<t>The SR Policy Association and its TLVs, defined in this document, allow PCEP speakers to exchange additional information about SR Policy Candidate Paths and their container SR Policy.
</t>

<section anchor="Motivation-group" title="Group Candidate Paths belonging to the same SR Policy">

<t>Since each SR Policy Candidate Path appears as a different Tunnel (identified via a PLSP-ID) in PCEP,
it is useful to group together all the SR Policy Candidate Paths that belong to the same SR Policy.
Furthermore, it is useful for the PCE to have knowledge of the SR Policy related information such as color, endpoint, protocol origin, discriminator, and preference.</t>

</section> <!-- Motivation-group -->

<section anchor="Motivation-candidate-path" title="Instantiation of SR Policy Candidate Paths">

<t>A PCE needs to instantiate one or more SR Policy Candidate Paths on the PCC, as specified in <xref target="RFC8281"/>.
Each SR Policy Candidate Path is identified by the tuple &#60;headend, color, endpoint, originator, discriminator, preference&#62;.
This draft provides a mechanism to signal this information in PCEP.</t>

</section> <!-- Motivation-candidate-path -->

<section anchor="Motivation-preference" title="Avoid computing lower preference Candidate Paths">

<t>When a PCE knows that a given set of SR Policy Candidate Paths all belong to the same SR Policy, then path computation MAY be done on only the highest preference Candidate Path(s).
Path computation for lower preference paths is not necessary if one or two higher preference paths are already computed.
Since computing their paths will not affect traffic steering, it MAY be postponed until the higher preference paths become invalid.</t>

</section> <!-- Motivation-preference -->

<section anchor="Motivation-signaling-overhead" title="Minimal signaling overhead">

<t>When an SR Policy contains multiple SR Policy Candidate Paths computed by a PCE, such Candidate Paths can be created, updated and deleted independently of each other.
This is achieved by making each SR Policy Candidate Path correspond to a unique Tunnel (identified via PLSP-ID).
For example, if an SR Policy has 4 SR Policy Candidate Paths, then if the PCE wants to update one of those, only one set of PCUpd and PCRpt messages needs to be exchanged.</t>

</section> <!-- Motivation-signaling-overhead -->

</section> <!-- Motivation -->

<section anchor="Procedure" title="Procedure">

<section anchor="Overview" title="Overview">

<t>As per <xref target="RFC8697"/>, LSPs are placed into an association group. As per <xref target="I-D.koldychev-pce-operational"/>,
LSPs are contained in PCEP Tunnels and a PCEP Tunnel is contained in an Association if all of its LSPs are in that Association.
PCEP Tunnels naturally map to SR Policy Candidate Paths and PCEP Associations naturally map to SR Policies.</t>

<t>The mapping between PCEP Associations and SR Policies is always one-to-one.
However, the mapping between PCEP Tunnels and SR Policy Candidate Paths may be either one-to-one, or many-to-one, see <xref target="MultipleObjectives"/>.</t>

<t>Each SR Policy Candidate Path contains one or more Segment Lists.
The subject of encoding multiple Segment Lists within an SR Policy Candidate Path is described in <xref target="I-D.ietf-pce-multipath"/>.</t>

<t>
This document defines a new Association Type called "SR Policy Association" (SRPA), of value 6 based on the generic ASSOCIATION object.
</t>

<t>As per the processing rules specified in section 6.4 of <xref target="RFC8697"/>, if a PCEP speaker does not support SRPA,
it MUST return a PCErr message with
Error-Type = 26 "Association Error", Error-Value = 1 "Association-type is not supported".</t>

<t>A given LSP MUST belong to at most one SRPA, since an SR Policy Candidate Path cannot belong to multiple SR Policies.
If a PCEP speaker receives a PCEP message requesting to join more than one SRPA for the same LSP,
then the PCEP speaker MUST send a PCErr message with
Error-Type = 26 "Association Error", Error-Value = 7 "Cannot join the association group".</t>

<t>An SRPA carries three pieces of information:
SR Policy Identifiers, SR Policy Candidate Path Identifiers, and SR Policy Candidate Path Attributes.</t>

<section anchor="SRPolicyIdentifiers" title="SR Policy Identifiers">
<t>SR Policy Identifiers uniquely identify the SR Policy within the context of the headend.
SR Policy Identifiers MUST be the same for all SR Policy Candidate Paths in the same SRPA.
SR Policy Identifiers MUST NOT change for a given SR Policy Candidate Path during its lifetime.
SR Policy Identifiers MUST be different for different SRPAGs.
SR Policy Identifiers consist of:</t>
<t>
      <list style="symbols">
        <t>Headend router where the SR Policy originates.</t>
        <t>Color of SR Policy.</t>
        <t>Endpoint of SR Policy.</t>
      </list>
</t>
</section>

<section anchor="SRPolicyCandidatePathIdentifiers" title="SR Policy Candidate Path Identifiers">
<t>SR Policy Candidate Path Identifiers uniquely identify the SR Policy Candidate Path within the context of an SR Policy.
SR Policy Candidate Path Identifiers MUST NOT change for a given LSP during its lifetime.
SR Policy Candidate Path Identifiers MUST be different for different LSPs within the same SRPA.
When these rules are not satisfied, the PCE MUST send a PCErr message with
Error-Type = 26 "Association Error", Error Value = TBD8 "SR Policy Candidate Path Identifiers Mismatch".
SR Policy Candidate Path Identifiers consist of:</t>
<t>
      <list style="symbols">
        <t>Protocol Origin.</t>
        <t>Originator.</t>
        <t>Discriminator.</t>
      </list>
</t>
</section>

<section anchor="SRPolicyCandidatePathAttributes" title="SR Policy Candidate Path Attributes">
<t>SR Policy Candidate Path Attributes carry non-key information about the Candidate Path and MAY change during the lifetime of the LSP.
SR Policy Candidate Path Attributes consist of:</t>
<t>
      <list style="symbols">
        <t>Preference.</t>
        <t>Optionally, the SR Policy Candidate Path name.</t>
        <t>Optionally, the SR Policy name.</t>
      </list>
</t>
</section>

</section> <!-- Overview -->

<section anchor="MultipleObjectives" title="Multiple Optimization Objectives and Constraints">

<t>In certain scenarios, it is desired for each SR Policy Candidate Path to contain multiple sub-Candidate Paths, each of which has a different optimization objective and constraints. Traffic is then sent ECMP or UCMP among these sub-Candidate Paths.</t>

<t>This is represented in PCEP by a many-to-one mapping between PCEP Tunnels and SR Policy Candidate Paths. This means that multiple PCEP Tunnels are allocated for each SR Policy Candidate Path. Each PCEP Tunnel has its own optimization objective and constraints. When a single SR Policy Candidate Path contains multiple PCEP Tunnels, each of these PCEP Tunnels MUST have identical values of Candidate Path Identifiers, as encoded in SRPOLICY-CPATH-ID TLV, see <xref target="Cpath-identifiers-tlv"/>.</t>

</section> <!-- MultipleObjectives -->

</section> <!-- Procedure -->

<section anchor="Association" title="SR Policy Association">

<t>Two ASSOCIATION object types for IPv4 and IPv6 are defined in <xref target="RFC8697"/>. The ASSOCIATION object includes "Association Type" indicating the type of the association group.
This document adds a new Association Type (6) "SR Policy Association".
This Association Type is dynamic in nature, thus operator-configured Association
Range MUST NOT be set for this Association type and MUST be ignored.</t>

<section anchor="AssociationParameters" title="Association Parameters">

<t>
As per <xref target="RFC9256"/>,
an SR Policy is identified through the tuple &#60;headend, color, endpoint&#62;.
the headend is encoded as the Association Source in the ASSOCIATION object and
the color and endpoint are encoded as part of Extended Association ID TLV.
</t>

<t>The Association Parameters (see <xref target="Terminology"/>) consist of:</t>
<t>
      <list style="symbols">
        <t>Association Type: set to 6 "SR Policy Association".</t>
        <t>Association Source (IPv4/IPv6): set to the headend IP address.</t>
        <t>Association ID (16-bit): set to "1".</t>
        <t>Extended Association ID TLV: encodes the Color and Endpoint of the SR Policy.</t>
      </list>
</t>

<t>The Association Source MUST be set to the headend value of the SR Policy, as defined in <xref target="RFC9256"/> Section 2.1.
If the PCC receives a PCInit message for a non-existent SR Policy, where the Association Source is set not to the headend value but to some globally unique IP address that the PCC owns,
then the PCC SHOULD accept the PCInit message and create the SR Policy Association with the Association Source that was sent in the PCInit message.</t>

<t>The 16-bit Association ID field in the ASSOCIATION object MUST be set to the value of "1".</t>

<t>The Extended Association ID TLV MUST be included and it MUST be in the following format:</t>

<figure anchor="Extended-Association-ID-TLV-FORMAT" title="Extended Association ID TLV format">
<artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |           Type = 31           |       Length = 8 or 20        |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                             Color                             |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  ~                           Endpoint                            ~
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>Type: Extended Association ID TLV, type = 31.</t>

<t>Length: Either 8 or 20, depending on whether IPv4 or IPv6 address is encoded in the Endpoint.</t>

<t>Color: SR Policy color value.</t>

<t>Endpoint: can be either IPv4 or IPv6, depending on whether the policy endpoint is IPv4 or IPv6.
This value MAY be different from the one contained in the END-POINTS object, or in the LSP IDENTIFIERS TLV of the LSP object.
This value is part of the tuple &#60;color, endpoint&#62; that identifies the SR Policy on a given headend.</t>

<t>If the PCEP speaker receives an SRPA object
whose Association Parameters do not follow the above specification,
then the PCEP speaker MUST send PCErr message with
Error-Type = 26 "Association Error", Error-Value = TBD7 "SR Policy Identifiers Mismatch".</t>

<t>The purpose of choosing the Association Parameters in this way is to guarantee that there is no possibility of a race condition when multiple PCEP speakers want to create the same SR Policy at the same time. By adhering to this format, all PCEP speakers come up with the same Association Parameters independently of each other. Thus, there is no chance that different PCEP speakers will come up with different Association Parameters for the same SR Policy.</t>

</section> <!-- AssociationParameters -->

<section anchor="AssociationInformation" title="Association Information">

<t>The SRPA object contains the following TLVs:</t>

<t>
      <list style="symbols">
        <t>SRPOLICY-POL-NAME TLV: (optional) encodes SR Policy Name string.</t>
        <t>SRPOLICY-CPATH-ID TLV: (mandatory) encodes SR Policy Candidate Path Identifiers.</t>
        <t>SRPOLICY-CPATH-NAME TLV: (optional) encodes SR Policy Candidate Path string name.</t>
        <t>SRPOLICY-CPATH-PREFERENCE TLV: (optional) encodes SR Policy Candidate Path preference value.</t>
      </list>
</t>

<t>Of these new TLVs, SRPOLICY-CPATH-ID TLV is mandatory.
When a mandatory TLV is missing from the SRPA object, the PCE MUST send a PCErr message with
Error-Type = 6 "Mandatory Object Missing", Error-Value = TBD6 "Missing Mandatory TLV".</t>

<section anchor="Policy-name-tlv" title="SR Policy Name TLV">

<t>The SRPOLICY-POL-NAME TLV is an optional TLV for the SRPA object.
At most one SRPOLICY-POL-NAME TLV SHOULD be encoded by the sender and only the first occurrence is processed and any others MUST be ignored.</t>

<figure anchor="SRPOLICY-POL-NAME-TLV-FORMAT" title="The SRPOLICY-POL-NAME TLV format">
<artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Type              |             Length            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  ~                       SR Policy Name                          ~
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>Type: 56 for "SRPOLICY-POL-NAME" TLV.</t>

<t>Length: indicates the length of the value portion of the TLV in octets and MUST be greater than 0. The TLV MUST be zero-padded so that the TLV is 4-octet aligned.</t>

<t>SR Policy Name: SR Policy name, as defined in <xref target="RFC9256"/>. It SHOULD be a string of printable ASCII characters, without a NULL terminator.</t>

</section> <!-- Policy-name-tlv -->

<section anchor="Cpath-identifiers-tlv" title="SR Policy Candidate Path Identifiers TLV">

<t>The SRPOLICY-CPATH-ID TLV is a mandatory TLV for the SRPA object.
Only one SRPOLICY-CPATH-ID TLV SHOULD be encoded by the sender and only the first occurrence is processed and any others MUST be ignored.</t>

<figure anchor="SRPOLICY-CPATH-ID-TLV-FORMAT" title="The SRPOLICY-CPATH-ID TLV format">
<artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Type              |             Length            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Proto. Origin |                      MBZ                      |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                         Originator ASN                        |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                       Originator Address                      |
  |                                                               |
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                         Discriminator                         |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>Type: 57 for "SRPOLICY-CPATH-ID" TLV.</t>

<t>Length: 28.</t>

<t>Protocol Origin: 8-bit value that encodes the protocol origin, as specified in <xref target="RFC9256"/> Section 2.3. Note that in PCInit messages, the Protocol Origin is always set to "PCEP".</t>

<t>Originator ASN: Represented as 4 byte number, part of the originator identifier, as specified in <xref target="RFC9256"/> Section 2.4.</t>

<t>Originator Address: Represented as 128 bit value where IPv4 address are encoded in lowest 32 bits, part of the originator identifier, as specified in <xref target="RFC9256"/> Section 2.4.</t>

<t>Discriminator: 32-bit value that encodes the Discriminator of the Candidate Path.</t>

</section> <!-- Cpath-identifiers-tlv -->

<section anchor="SRPOLICY-CPATH-NAME" title="SR Policy Candidate Path Name TLV">

<t>The SRPOLICY-CPATH-NAME TLV is an optional TLV for the SRPA object.
At most one SRPOLICY-CPATH-NAME TLV SHOULD be encoded by the sender and only the first occurrence is processed and any others MUST be ignored.</t>

<figure anchor="SRPOLICY-CPATH-NAME-TLV-FORMAT" title="The SRPOLICY-CPATH-NAME TLV format">
<artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Type              |             Length            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  ~                 SR Policy Candidate Path Name                 ~
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>Type: 58 for "SRPOLICY-CPATH-NAME" TLV.</t>

<t>Length: indicates the length of the value portion of the TLV in octets and MUST be greater than 0. The TLV MUST be zero-padded so that the TLV is 4-octet aligned.</t>

<t>SR Policy Candidate Path Name: SR Policy Candidate Path Name, as defined in <xref target="RFC9256"/>. It SHOULD be a string of printable ASCII characters, without a NULL terminator.</t>

</section> <!-- SRPOLICY-CPATH-NAME -->

<section anchor="Cpath-preference-tlv" title="SR Policy Candidate Path Preference TLV">

<t>The SRPOLICY-CPATH-PREFERENCE TLV is an optional TLV for the SRPA object.
Only one SRPOLICY-CPATH-PREFERENCE TLV SHOULD be encoded by the sender and only the first occurrence is processed and any others MUST be ignored.</t>

<figure anchor="SRPOLICY-CPATH-PREFERENCE-TLV-FORMAT" title="The SRPOLICY-CPATH-PREFERENCE TLV format">
<artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Type              |             Length            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                           Preference                          |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>Type: 59 for "SRPOLICY-CPATH-PREFERENCE" TLV.</t>

<t>Length: 4.</t>

<t>Preference: Numerical preference of the Candidate Path, as specified in Section 2.7 of <xref target="RFC9256"/>.</t>

<t>If the TLV is missing, a default Preference value of 100 is used, as specified in Section 2.7 of <xref target="RFC9256"/>.</t>

</section> <!-- Cpath-preference-tlv -->

</section> <!-- AssociationInformation -->

</section> <!-- Association -->

<section anchor="Generic-mechanisms" title="Generic Mechanisms">

<t>This section describes various mechanisms that are standardized for SR Policies in <xref target="RFC9256"/>,
but are equally applicable to other tunnel types, such as RSVP-TE tunnels.
Hence this section does not make use of the SRPA.</t>

<section anchor="Computation-priority-tlv" title="Computation Priority TLV">

<t>The COMPUTATION-PRIORITY TLV is an optional TLV for the LSP object.
It is used to signal the numerical computation priority, as specified in Section 2.12 of <xref target="RFC9256"/>.
If the TLV is absent from the LSP object, a default Priority value of 128 is used.</t>

<figure anchor="COMPUTATION-PRIORITY-TLV-FORMAT" title="The COMPUTATION-PRIORITY TLV format">
<artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Type              |             Length            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |    Priority    |                     MBZ                      |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>Type: TBD1 for "COMPUTATION-PRIORITY" TLV.</t>

<t>Length: 4.</t>

<t>Priority: Numerical priority with which this LSP is to be recomputed by the PCE upon topology change.</t>

</section> <!-- Computation-priority-tlv -->

<section anchor="enlp-tlv" title="Explicit Null Label Policy (ENLP) TLV">

<t>The ENLP TLV is an optional TLV for the LSP object.
It is used to implement the "Explicit Null Label Policy", as specified in Section 2.4.5 of <xref target="I-D.ietf-idr-segment-routing-te-policy"/>.</t>

<figure anchor="ENLP-TLV-FORMAT" title="The Explicit Null Label Policy (ENLP) TLV format">
<artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Type              |             Length            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |    ENLP        |                     MBZ                      |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>Type: TBD2 for "ENLP" TLV.</t>

<t>Length: 4.</t>

<t>ENLP (Explicit NULL Label Policy): same values as in Section 2.4.5 of <xref target="I-D.ietf-idr-segment-routing-te-policy"/>.</t>

</section> <!-- enlp-tlv -->

<section anchor="Invalidation-tlv" title="Invalidation TLV">

<t>The INVALIDATION TLV is an optional TLV for the LSP object.
It is used to control traffic streering into the LSP
during the time when the LSP is operationally down/invalid.
In the context of SR Policy, this TLV facilitates 
the "Drop upon invalid" behavior,
specified in Section 8.2 of <xref target="RFC9256"/>.
Normally, if the LSP is down/invalid then traffic that is originally destined for that LSP
is steered somewhere else, such as via IGP or via another LSP.
The "Drop upon invalid" behavior specifies that such traffic MUST NOT be re-routed
and has to be dropped at the head-end.
While in the "Drop upon invalid" state, the LSP operational state is "UP",
as indicated by the O-flag in the LSP object.
However the ERO object is empty, indicating that traffic is being dropped.
</t>
<t>
In addition to the above, this TLV can also be used by the PCC to report to the PCE
various reasons for LSP being invalidated.
Invalidation reasons are represented by a set of flags.
</t>

<figure anchor="INVAL_FLAGS" title="Invalidation Reasons Flags">
<artwork align="center"><![CDATA[
   0 1 2 3 4 5 6 7 
  +-+-+-+-+-+-+-+-+
  |       |V|P|F|U|
  +-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>
  <list style="symbols">
    <t>G: Generic - does not fit into any other categories below.</t>
    <t>P: Path computation failure - no path was computed for the LSP.</t>
    <t>F: First-hop resolution failure - head-end first hop resolution has failed.</t>
    <t>V: Verification failure - OAM/PM/BFD path verification has indicated a breakage.</t>
  </list>
</t>

<figure anchor="INVALIDATION-TLV-FORMAT" title="The INVALIDATION TLV format">
<artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Type              |             Length            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Inval Reason  |   Drop Upon   |              MBZ              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>Type: TBD3 for "INVALIDATION" TLV.</t>

<t>Length: 4.</t>

<t>Inval Reason: contains "Invalidation Reasons Flags" which encode the 
reason(s) why the LSP is currently invalidated.
This field can be set to non-zero values only by the PCC,
it MUST be set to 0 by the PCE and ignored by the PCC.
</t>

<t>Drop Upon: contains "Invalidation Reasons Flags" for conditions
that MUST cause the LSP to drop traffic.
This field can be set to non-zero values by both PCC and PCE.
When the G-flag is set, this indicates that the LSP is to go into
Drop upon invalid state for any reason. I.e., when the PCE does not wish to
distinguish any reason for LSP invalidation and just simply wants it to
always "Drop upon invalid" for any reason.
Note that when the G-flag is set, the values of the other flags are irrelevant.
</t>

</section> <!-- Invalidation-tlv -->

<section anchor="Specified-bsid-only" title="Specified-BSID-only">

<t>Specified-BSID-only functionality is defined in Section 6.2.3 of <xref target="RFC9256"/>.
When specified-BSID-only is enabled for a particular binding SID, it means that the given binding SID is required to be allocated and programmed for the LSP to be operationally up.
If the binding SID cannot be allocated or programmed for some reason, then the LSP must stay down.</t>

<t>To signal specified-BSID-only, a new bit: S (Specified-BSID-only) is allocated in the "TE-PATH-BINDING TLV Flag field" of the TE-PATH-BINDING TLV.
When this bit is set for a particular BSID, it means that the BSID follows the Specified-BSID-only behavior.
It is possible to have a mix of BSIDs for the same LSP: some with S=1 and some with S=0.</t>

</section> <!-- Specified-bsid-only -->

</section> <!-- Generic-mechanisms -->

<section anchor="RRO" title="Use of SR-RRO and SRv6-RRO objects">

<t><xref target="RFC8231"/> defines a PCRpt message which contains &#60;intended-path&#62; known as the ERO object and &#60;actual-path&#62; known as the RRO object. <xref target="RFC8664"/> defines SR-ERO and SR-RRO sub-objects for SR-TE LSPs. <xref target="I-D.ietf-pce-segment-routing-ipv6"/> further defines SRv6-ERO and SRv6-RRO sub-objects for SRv6-TE paths.</t>

<t>In practice RRO data is the result of signalling via a protocol such as RSVP-TE, which allows collection of per-hop information along the path. The ERO and RRO values may be different as the path encoded in the ERO may differ than the RRO such as during protection conditions or if the ERO contains loose hops which are expanded upon. As Segment Routing LSP does not perform any signalling, the values of an SR-ERO/SRv6-ERO and SR-RRO/SRv6-RRO (respectively) are in practice the same, therefore some implementations have omitted the RRO when reporting a SR-TE LSP while others continue to send both ERO and RRO values.</t>
 
<t>The following applies to SR-TE only. If both ERO and RRO are present for the same LSP, it SHOULD be interpreted as the RRO being the actual path the LSP is taking but MAY interpret only the ERO as the actual path. In the absence of RRO a PCE MUST interpret the ERO as the actual path for the LSP. Until SR-TE introduces some form of signaling similar to RSVP-TE, the use of RRO is discouraged for SR-TE LSPs.</t>

</section> <!-- RRO -->

<section title="IANA Considerations">

<section title="Association Type">
<t>This document defines a new association type: SR Policy Association.
IANA is requested to make the following codepoint assignment in the
"ASSOCIATION Type Field" subregistry <xref target="RFC8697"/> within
the "Path Computation Element Protocol (PCEP) Numbers" registry:</t>
<t>
<figure>
        <artwork align="left"><![CDATA[
+-----------+-------------------------------------------+-----------+
| Type      | Name                                      | Reference |
+-----------+-------------------------------------------+-----------+
| 6         | SR Policy Association                     | This.I-D  |
+-----------+-------------------------------------------+-----------+
]]></artwork>
      </figure>
</t>
</section>

<section title="PCEP TLV Type Indicators">
<t>This document defines four new TLVs for carrying additional information about SR Policy and SR Candidate Paths. IANA is requested to make the assignment of a new value for the existing "PCEP TLV Type Indicators" registry as follows:</t>
<t>
<figure>
        <artwork align="left"><![CDATA[
+-----------+-------------------------------------------+-----------+
| Value     | Description                               | Reference |
+-----------+-------------------------------------------+-----------+
| 56        | SRPOLICY-POL-NAME                         | This.I-D  |
+-----------+-------------------------------------------+-----------+
| 57        | SRPOLICY-CPATH-ID                         | This.I-D  |
+-----------+-------------------------------------------+-----------+
| 58        | SRPOLICY-CPATH-NAME                       | This.I-D  |
+-----------+-------------------------------------------+-----------+
| 59        | SRPOLICY-CPATH-PREFERENCE                 | This.I-D  |
+-----------+-------------------------------------------+-----------+
| TBD1      | COMPUTATION-PRIORITY                      | This.I-D  |
+-----------+-------------------------------------------+-----------+
| TBD2      | EXPLICIT-NULL-LABEL-POLICY                | This.I-D  |
+-----------+-------------------------------------------+-----------+
| TBD3      | INVALIDATION                              | This.I-D  |
+-----------+-------------------------------------------+-----------+
]]></artwork>
      </figure>
</t>
</section>

<section title="PCEP Errors">
<t>This document defines one new Error-Value within the "Mandatory Object Missing" Error-Type and two new Error-Values within the "Association Error" Error-Type.
IANA is requested to allocate new error values within the "PCEP-ERROR Object Error Types and Values" sub-registry of the PCEP Numbers registry, as follows:</t>
<t>
<figure>
        <artwork align="left"><![CDATA[
+------------+------------------+-----------------------+-----------+
| Error-Type | Meaning          | Error-value           | Reference |
+------------+------------------+-----------------------+-----------+
| 6          | Mandatory Object |                       | [RFC5440] |
|            | Missing          |                       |           |
+------------+------------------+-----------------------+-----------+
|            |                  | TBD6: SR Policy       | This.I-D  |
|            |                  | Missing Mandatory TLV |           |
+------------+------------------+-----------------------+-----------+
| 26         | Association      |                       | [RFC8697] |
|            | Error            |                       |           |
+------------+------------------+-----------------------+-----------+
|            |                  | TBD7: SR Policy       | This.I-D  |
|            |                  | Identifers Mismatch   |           |
+------------+------------------+-----------------------+-----------+
|            |                  | TBD8: SR Policy       | This.I-D  |
|            |                  | Candidate Path        |           |
|            |                  | Identifiers Mismatch  |           |
+------------+------------------+-----------------------+-----------+

]]></artwork>
      </figure>
</t>
</section>

<section title="TE-PATH-BINDING TLV Flag field">
<t>
IANA is requested to allocate new bit within the "TE-PATH-BINDING TLV Flag field" sub-registry of the PCEP Numbers registry, as follows:</t>
<t>
<figure>
        <artwork align="left"><![CDATA[
+------------+------------------------------------------+-----------+
| Bit position | Description                            | Reference |
+--------------+----------------------------------------+-----------+
| 1            | Specified-BSID-only                    | This.I-D  |
+--------------+----------------------------------------+-----------+

]]></artwork>
      </figure>
</t>
</section>

</section> 

<section  title="Implementation Status">
      <t>[Note to the RFC Editor - remove this section before publication, as
      well as remove the reference to RFC 7942.]</t>

      <t>This section records the status of known implementations of the
      protocol defined by this specification at the time of posting of this
      Internet-Draft, and is based on a proposal described in <xref
      target="RFC7942"/>. The description of implementations in this section
      is intended to assist the IETF in its decision processes in progressing
      drafts to RFCs. Please note that the listing of any individual
      implementation here does not imply endorsement by the IETF. Furthermore,
      no effort has been spent to verify the information presented here that
      was supplied by IETF contributors. This is not intended as, and must not
      be construed to be, a catalog of available implementations or their
      features. Readers are advised to note that other implementations may
      exist.</t>
 

      <t>According to <xref target="RFC7942"/>, "this will allow reviewers and
      working groups to assign due consideration to documents that have the
      benefit of running code, which may serve as evidence of valuable
      experimentation and feedback that have made the implemented protocols
      more mature. It is up to the individual working groups to use this
      information as they see fit".</t>

      <section anchor="Cisco" title="Cisco">
        <t><list style="symbols">
            <t>Organization: Cisco Systems</t>

            <t>Implementation: IOS-XR PCC and PCE.</t>

            <t>Description: An experimental code-point is currently used.</t>

            <t>Maturity Level: Proof of concept.</t>

            <t>Coverage: Full.</t>

            <t>Contact: mkoldych@cisco.com</t>
          </list></t>
      </section>

      <section anchor="Juniper" title="Juniper">
        <t><list style="symbols">
            <t>Organization: Juniper Networks</t>

            <t>Implementation: Head-end and controller.</t>

            <t>Description: An experimental code-point is currently used.</t>

            <t>Maturity Level: Proof of concept.</t>

            <t>Coverage: Partial.</t>

            <t>Contact: cbarth@juniper.net</t>
          </list></t>
      </section>

</section> 

<section  title="Security Considerations">
      <t>This document defines one new type for association, which do not add any new
      security concerns beyond those discussed in <xref target="RFC5440"/>,
      <xref target='RFC8231'/>, <xref target="RFC8664"/>, <xref target="I-D.ietf-pce-segment-routing-ipv6"/> and <xref target='RFC8697'/> in itself.
      </t>
     <t>
The information carried in the SRPA object, as per this document is related to SR Policy. 
It often reflects information
that can also be derived from the SR Database, but association provides a much easier grouping of related LSPs and messages.
The SRPA could provide an adversary with the opportunity to eavesdrop on the relationship between the LSPs.
Thus securing the PCEP session using Transport Layer
   Security (TLS) <xref target="RFC8253"/>, as per the recommendations and
   best current practices in <xref target="RFC7525"/>, is RECOMMENDED.</t>
</section> 

<section anchor="Acknowledgement" title="Acknowledgement">
<t>
Would like to thank Stephane Litkowski, Boris Khasanov, Praveen Kumar and Tom Petch for review and suggestions.
</t>
</section> <!-- Acknowledgement -->

</middle>

<back>

<references title="Normative References">
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5440.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.8174.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.8231.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.8281.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.7942.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.9256.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-idr-segment-routing-te-policy.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.8697.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.8664.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.koldychev-pce-operational.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-pce-multipath.xml"?>
</references>
<references title="Informative References">
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.4655.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.7525.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.8253.xml"?>
  <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-pce-segment-routing-ipv6.xml"?>
  <!--<?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.sivabalan-pce-binding-label-sid"?>-->
</references>
<section title="Contributors">
    <t><figure><artwork>
Dhruv Dhody
Huawei Technologies
Divyashree Techno Park, Whitefield
Bangalore, Karnataka  560066
India

Email: dhruv.ietf@gmail.com 

Cheng Li
Huawei Technologies
Huawei Campus, No. 156 Beiqing Rd.
Beijing, 10095
China

Email: chengli13@huawei.com     

Samuel Sidor
Cisco Systems, Inc.
Eurovea Central 3.
Pribinova 10
811 09 Bratislava
Slovakia

Email: ssidor@cisco.com
    </artwork></figure></t>  


</section> <!-- Contributors -->

</back>

</rfc>

